!function(e){"undefined"==typeof Twi&&(this.Twi={}),Twi.global=this,Messenger&&(Messenger.options={extraClasses:"messenger-fixed messenger-on-bottom messenger-on-right",theme:"future"}),Twi.Msg={Success:function(s){"string"==typeof s&&(s={message:s}),s=s||{};var t=e.extend({message:"操作成功",type:"success",hideAfter:2,showCloseButton:!0},s);Messenger().post(t)},Info:function(s){"string"==typeof s&&(s={message:s}),s=s||{};var t=e.extend({message:"操作成功",type:"info",hideAfter:2,showCloseButton:!0},s);Messenger().post(t)},Error:function(s){"string"==typeof s&&(s={message:s}),s=s||{};var t=e.extend({message:"操作失败",type:"error",hideAfter:5,showCloseButton:!0},s);Messenger().post(t)},Comfirm:function(e,s){s=s||"执行后数据不能恢复，你确定要执行吗？";var t=Messenger().post({message:s,showCloseButton:!0,actions:{retry:{label:"是",action:function(){t.cancel(),"function"==typeof e&&e()}},cancel:{label:"否",action:function(){return t.cancel()}}}})}}}(window.jQuery);
!function(e){"undefined"==typeof Twi&&(this.Twi={}),Twi.global=this,Twi.emptyFn=function(){},Twi.Url="/PageHandler.ashx",Twi.Ajax=function(i){var n,o=e.extend({url:Twi.Url,dataType:"JSON",type:"POST",loadingMask:!1,maskMsg:"正在处理请稍后...",errorMsgTarget:"body",emptyMsg:!1},i);o.loadingMask&&(n=new Twi.LoadingMask({msg:o.maskMsg})).show(),delete o.loadMask,delete o.maskMsg,o.success=function(n,s,r){n.success?"function"==typeof i.success&&i.success(n):(Twi.Msg?Twi.Msg.Error(n.message):(o.emptyMsg&&e(o.errorMsgTarget).emptyMsg(),e(o.errorMsgTarget).append('<div class="alert alert-warning alert-dismissable"><button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button><strong>温馨提示：</strong>'+n.errors+"</div>")),"102"==n.knowError&&("function"==typeof Twi.QuickReLogin?Twi.QuickReLogin():location.href="/Login/Index"))},o.complete=function(){"function"==typeof i.complete&&i.complete(),n&&n.hide()},e.ajax(o)},Twi.QuickReLogin=function(){0==e("#qrlContainer").length&&(e("body").append('<div id="qrlContainer"></div>'),e("#qrlContainer").load("/Platform/Login/QuickReLogin"))},Twi.PageSize=15,Twi.IsDeveloper=!1,Twi.NotDeveloperError="系统基础支撑数据，只能由开发人员维护，</br>否则系误操作可能会引起系统对应功能无法操作！",Twi.GetUrlParam=function(e){var i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(i);return null!=n?unescape(n[2]):null},Twi.Cookies={},Twi.Cookies.set=function(e,i){var n=arguments,o=arguments.length,s=o>2?n[2]:null,r=o>3?n[3]:"/",t=o>4?n[4]:null,a=o>5&&n[5];document.cookie=e+"="+escape(i)+(null==s?"":"; expires="+s.toGMTString())+(null==r?"":"; path="+r)+(null==t?"":"; domain="+t)+(1==a?"; secure":"")},Twi.Cookies.get=function(e){for(var i=e+"=",n=i.length,o=document.cookie.length,s=0,r=0;s<o;){if(r=s+n,document.cookie.substring(s,r)==i)return Twi.Cookies.getCookieVal(r);if(0==(s=document.cookie.indexOf(" ",s)+1))break}return null},Twi.Cookies.clear=function(e){Twi.Cookies.get(e)&&(document.cookie=e+"=; expires=Thu, 01-Jan-70 00:00:01 GMT")},Twi.Cookies.getCookieVal=function(e){var i=document.cookie.indexOf(";",e);return-1==i&&(i=document.cookie.length),unescape(document.cookie.substring(e,i))},Twi.CurrentUser={FID:Twi.Cookies.get("Twi_User_FID"),FREALNAME:Twi.Cookies.get("Twi_User_FREALNAME"),FNAME:Twi.Cookies.get("Twi_User_FNAME"),PHONENUMBER:Twi.Cookies.get("Twi_User_PHONENUMBER"),PARKCODE:Twi.Cookies.get("Twi_User_PARKCODE"),STORAGECODE:Twi.Cookies.get("Twi_User_STORAGECODE")},Twi.ClearUserCookies=function(){Twi.Cookies.clear("Twi_User_FID"),Twi.Cookies.clear("Twi_User_FREALNAME"),Twi.CurrentUser.FID="",Twi.CurrentUser.FREALNAME="",Twi.CurrentUser.FNAME="",Twi.CurrentUser.PHONENUMBER="",Twi.CurrentUser.PARKCODE="",Twi.CurrentUser.STORAGECODE=""},e(function(){"undefined"!=typeof twiSelf&&(twiVars&&0==twiVars.autoInit||"function"==typeof twiSelf.init&&twiSelf.init())}),Twi.Skin={turquoise:{skinColor:"#1ABC9C",skinColor2:"#16A085",skinName:"绿松石",skinCode:"turquoise",skinIndex:0},sunorange:{skinColor:"#F1C40F",skinColor2:"#F39C12",skinName:"向日橙",skinCode:"sunorange",skinIndex:1},dreamblue:{skinColor:"#3498DB",skinColor2:"#2980B9",skinName:"梦之蓝",skinCode:"dreamblue",skinIndex:2},amethyst:{skinColor:"#9B59B6",skinColor2:"#8E44AD",skinName:"紫水晶",skinCode:"amethyst",skinIndex:3},emerland:{skinColor:"#2ECC71",skinColor2:"#27AE60",skinName:"祖母绿",skinCode:"emerland",skinIndex:4},rainright:{skinColor:"#34495E",skinColor2:"#2C3E50",skinName:"黑雨夜",skinCode:"rainright",skinIndex:5},alizarin:{skinColor:"#E74C3C",skinColor2:"#C0392B",skinName:"茜素红",skinCode:"alizarin",skinIndex:6},brown:{skinColor:"#E67E22",skinColor2:"#D35400",skinName:"古韵棕",skinCode:"brown",skinIndex:7}}}(window.jQuery);
!function(){"undefined"==typeof Twi&&(this.Twi={}),Twi.global=this,Twi.Confirm=function(i){i=$.extend({html:"确定要执行此操作?",contentEl:null,showCancel:!0,btnOKText:"确定",btnCancelText:"取消",appendTo:"body",autoClose:!0,fn:function(){}},i),this.config=i,this.id="TwiConfirm"+Math.floor(1e5*Math.random())},Twi.Confirm.prototype.show=function(){var i='<div class="twiConfirmContainer" id="'+this.id+'">';if(i+='<div class="twiConfirm">',i+='<div class="twiConfirmBody">'+this.config.html+"</div>",i+='<div class="twiConfirmFooter">',i+='<a class="twiConfirmBtn twiConfirmBtnOK">'+this.config.btnOKText+"</a>",this.config.showCancel&&(i+='<a class="twiConfirmBtn twiConfirmBtnCancel">'+this.config.btnCancelText+"</a>"),i+="</div>",i+="</div>",i+='<div class="twiConfirmBackdrop"></div>',i+="</div>",$(this.config.appendTo).append(i),this.config.contentEl&&$(this.config.contentEl).length>0&&$("#"+this.id).find(".twiConfirmBody").empty().append($(this.config.contentEl).html()),this.config.showCancel){n=this;$("#"+this.id).find(".twiConfirmBtnCancel").click(function(){n.close()})}if("function"==typeof this.config.fn){var n=this;$("#"+this.id).find(".twiConfirmBtnOK").click(function(){n.config.fn(n),n.config.autoClose&&n.close()})}},Twi.Confirm.prototype.close=function(){$("#"+this.id).remove()},Twi.Confirm.prototype.getId=function(){return this.id}}();
!function(){function i(i){if(!i||"auto"==i){var n=["turquoise","sunorange","dreamblue","amethyst","emerland","rainright","alizarin","brown"];i=n[Math.floor(100*Math.random())%n.length]}return i}"undefined"==typeof Twi&&(this.Twi={}),Twi.global=this,Twi.LoadingMask=function(i){var n=this;n.VERSION="1.1.0",n.PUBLICTIME="2015-03-28 12:21:45",n.defaults={msg:"系统正在处理,请稍候...",skin:"auto"},i=i||{},n.config=$.extend({},n.defaults,i),n.id="TwiLoadingMask"+Math.floor(1e5*Math.random())},Twi.LoadingMask.prototype.getId=function(){return this.id},Twi.LoadingMask.prototype.show=function(){var n=this,o='<div class="twiLoadingMask" id="'+n.id+'">';o+='<div class="twiLoadingMaskBg"></div>',o+='<div class="twiLoadingMaskCnt">',o+='<div class="twiLoadingMaskTop"></div>',o+='<div class="twiLoadingMaskMid"></div>',o+='<div class="twiLoadingMaskBtm"></div>',o+='<div class="twiLoadingMaskMsg">'+n.config.msg+"</div>",o+="</div>",o+="</div>",$("body").append(o),n.changeSkin(i(n.config.skin));var s=0,a=$("#"+this.id).find(".twiLoadingMaskBtm");!function o(){a.animate({width:"100%"},3e3,function(){s=100,a.width(0),"auto"==n.config.skin&&n.changeSkin(i()),o()})}()},Twi.LoadingMask.prototype.hide=function(){$("#"+this.id).remove()},Twi.LoadingMask.prototype.changeSkin=function(i){var n=Twi.Skin[i];if(n){var o=$("#"+this.id).find(".twiLoadingMaskBg"),s=$("#"+this.id).find(".twiLoadingMaskCnt"),a=$("#"+this.id).find(".twiLoadingMaskMid"),d=$("#"+this.id).find(".twiLoadingMaskBtm");o.css({"background-color":n.skinColor}),s.css({"border-color":n.skinColor}),a.css({"background-color":n.skinColor}),d.css({"background-color":n.skinColor})}},Twi.Skin=Twi.Skin||{turquoise:{skinColor:"#1ABC9C",skinColor2:"#16A085",skinName:"绿松石",skinCode:"turquoise",skinIndex:0},sunorange:{skinColor:"#F1C40F",skinColor2:"#F39C12",skinName:"向日橙",skinCode:"sunorange",skinIndex:1},dreamblue:{skinColor:"#3498DB",skinColor2:"#2980B9",skinName:"梦之蓝",skinCode:"dreamblue",skinIndex:2},amethyst:{skinColor:"#9B59B6",skinColor2:"#8E44AD",skinName:"紫水晶",skinCode:"amethyst",skinIndex:3},emerland:{skinColor:"#2ECC71",skinColor2:"#27AE60",skinName:"祖母绿",skinCode:"emerland",skinIndex:4},rainright:{skinColor:"#34495E",skinColor2:"#2C3E50",skinName:"黑雨夜",skinCode:"rainright",skinIndex:5},alizarin:{skinColor:"#E74C3C",skinColor2:"#C0392B",skinName:"茜素红",skinCode:"alizarin",skinIndex:6},brown:{skinColor:"#E67E22",skinColor2:"#D35400",skinName:"古韵棕",skinCode:"brown",skinIndex:7}}}();
!function(t){function e(t){return"function"==typeof t?t:function(){}}function n(t){return t=t||4,Math.floor(Math.pow(10,t)*Math.random())}function o(t,e){var n='<span class="glyphicon '+(t=t||"")+'"></span>';return n+='<span class="auto-hidden twiGlyphText">'+(e=e||"")+"</span>"}function a(e,n){"string"==typeof n&&t("#"+e).children(".glyphicon").css("color",n)}function i(t,e){e=(e=t.id||e)||c+"Btn"+n(),t.skin=t.skin||p;var a=t.skin==p?"":"btn-"+t.skin,i='<button id="'+e+'" type="button" '+l(t.twiFor)+' class="btn btn-default '+a+' btn-sm">';return i+=o(t.iconCls,t.text),i+="</button>"}function r(t,e,o){var a=t.id||e;a=a||c+"BtnGroup"+n(),t.skin=t.skin||p;t.skin==p||t.skin;var i=[],r="";r+='<div id="'+a+'" class="btn-group '+(t.dropup?"dropup":"")+' btn-group-sm">',r+='<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">'+t.text+'<span class="caret"></span></button>',r+='<ul class="dropdown-menu" '+l(t.twiFor)+' role="menu">';for(var d=0;d<t.children.length;d++){var s=o();i.push(s);var h=t.children[d];"string"==typeof h?r+='<li id="'+s+'"><a href="#">'+h+"</a></li>":(h.text=h.text||"",r+='<li id="'+s+'"><a href="#">'+h.text+"</a></li>")}return r+="</ul>",r+="</div>",{html:r,childrenIDs:i}}function l(t,e){return t?"single"==(e=e||"double")?" "+s+" = '"+t+"' ":"none"==e?s+"="+t:" "+s+' = "'+t+'" ':" "}function d(t,e){if(!(t instanceof Array))return t;e.idField=e.idField||"FID",e.parentIDField=e.parentIDField||"FPARENTID",e.rootParentIDValue=e.rootParentIDValue||"";for(var n=[],o=e._twiTgdLevel||0,a=0;a<t.length;a++)if(t[a]._twiTgdIsOver=t[a]._twiTgdIsOver||!1,""+t[a][e.parentIDField]==e.rootParentIDValue){t[a]._twiTgdIsOver=!0;var i=d(t,{idField:e.idField,parentIDField:e.parentIDField,rootParentIDValue:t[a][e.idField],_twiTgdLevel:1+o});t[a]._twiTgdIsLeaf=!(i.length>0),t[a]._twiChildrenCount=i.length,t[a]._twiTgdLevel=o,n.push(t[a]),n=n.concat(i)}return n}"undefined"==typeof Twi&&(this.Twi={emptyFn:function(){}}),Twi.global=this;var c="Twi",s="twifor",p="default",h=tbarXtype="tbar",f=bbarXtype="bbar",u=pbarXtype="pbar",g="queryItm",b="qgSltBtn",y="qgSltUL",v="autoQueryBtn",w="thdata";Twi.DataTable=function(d){var m=this;m.VERSION="1.3.6",m.PUBLICTIME="2017-9-11 17:24:46",m.defaults={renderTo:"body",rownumberer:{text:"",width:30},columns:[],striped:!0,multiSelect:!1,sortable:!0,paging:!1,autoLoad:!1},m._handlers={},d=d||{},(d=t.extend({},m.defaults,d))._showRowNumber=!0,"boolean"==typeof d.rownumberer&&(d.rownumberer?d.rownumberer=m.defaults.rownumberer:d._showRowNumber=!1),d._showCheckBox=!1,"boolean"==typeof d.checkBoxCol?(d.checkBoxCol||d.multiSelect)&&(d._showCheckBox=!0,d.checkBoxCol={width:30}):"object"==typeof d.checkBoxCol?(d._showCheckBox=!0,d.checkBoxCol.width=d.checkBoxCol.width||30):void 0===d.checkBoxCol&&d.multiSelect&&(d._showCheckBox=!0,d.checkBoxCol={width:30}),"object"==typeof d.quickQuery&&(d.quickQuery.dock=d.quickQuery.dock||"tbar"),d._showAsTreeGrid=!1;var x={idField:"FID",parentIDField:"FPARENTID",rootParentIDValue:"",model:"folder",preLevelPadding:18,folderIconCls:{open:"glyphicon-folder-open",close:"glyphicon-folder-close",leaf:"glyphicon-leaf",onlyRoot:"glyphicon-list-alt",childRoot:"glyphicon-pushpin"},plusIconCls:{open:"glyphicon-minus",close:"glyphicon-plus",leaf:"glyphicon-heart-empty",onlyRoot:"glyphicon-flash",childRoot:"glyphicon-pushpin"}};!0===d.treeGrid?(d.treeGrid=x,d._showAsTreeGrid=!0):"object"==typeof d.treeGrid&&(d.treeGrid=t.extend({},x,d.treeGrid),d._showAsTreeGrid=!0),m.config=d,m.frameId="TwiDtPanel"+n(),m.id="TwiDataTable"+n(),m.titleId="TwiDtTitle"+n(),m._idFieldValues=[],m._data=[],m.Obar={getItemId:function(t,e){return xtypeLetter=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(t),e=e||"Itm",c+xtypeLetter+e+n()},getPanelBodyObj:function(e){return t("#"+m.frameId).children(".panel-body").children("div["+l(e,"none")+"]")},addItem:function(e){function o(t){return m.Obar.getItemId(e.xtype,t)}function d(){return m.Obar.getPanelBodyObj(e.xtype)}m.Obar;var s=e.item;if(s.xtype=s.xtype||"button","button"==s.xtype){var h=o(),f=i(s,h);return s.position&&"first"==s.position?d().prepend(f):d().append(f),a(h,s.iconColor),"function"==typeof s.handler&&(s.eventType=s.eventType||"click",t("#"+h).off(s.eventType).on(s.eventType,s.handler)),h}if("btnGroup"==s.xtype){if(!(s.children instanceof Array))return;var u=o("GroupItm"),g=(b=function(t,e,o){var a=t.id||e;a=a||c+"BtnGroup"+n(),t.skin=t.skin||p,t.skin==p||t.skin;for(var d=[],s=t.cls||"",h='<div id="'+a+'" '+l(t.twiFor)+' class="btn-group  btn-group-sm '+s+'">',f=0;f<t.children.length;f++){var u=t.children[f],g=u.id||o();d.push(g),"string"==typeof u?h+=i({id:g,skin:t.skin,iconCls:t.iconCls,text:u}):"html"==u.xtype?h+=u.html:"text"==u.xtype?h+=u.text:"btnDdm"==u.xtype?h+=r(u,c+"BtnGroup"+n(),o).html:h+=i(u,g)}return h+="</div>",{html:h,childrenIDs:d}}(s,u,o)).childrenIDs,f=b.html;s.position&&"first"==s.position?d().prepend(f):d().append(f);for(v=0;v<s.children.length;v++){w=s.children[v];a(g[v],w.iconColor),"html"==w.xtype||"text"==w.xtype?"function"==typeof w.handler&&w.handler():"function"==typeof w.handler?(w.eventType=w.eventType||"click",t("#"+g[v]).off(w.eventType).on(w.eventType,function(t){return function(){t.handler({sender:this,text:t.text||t,item:t})}}(w))):"function"==typeof s.handler&&(s.eventType=s.eventType||"click",t("#"+g[v]).off(s.eventType).on(s.eventType,function(t){return function(){s.handler({sender:this,text:t.text||t,item:t})}}(w)))}return u}if("html"==s.xtype)s.position&&"first"==s.position?d().prepend(s.html):d().append(s.html),"function"==typeof s.handler&&s.handler();else{if("btnDdm"==s.xtype){u=o("GroupItm");"bbar"!=e.xtype&&"pbar"!=e.xtype||(s.dropup=!1!==s.dropup);var b=r(s,u,o),y=b.childrenIDs,f=b.html;s.position&&"first"==s.position?d().prepend(f):d().append(f);for(var v=0;v<s.children.length;v++){var w;"function"==typeof(w=s.children[v]).handler?(w.eventType=w.eventType||"click",t("#"+y[v]).off(w.eventType).on(w.eventType,function(t){return function(){t.handler({sender:this,text:t.text||t,item:t})}}(w))):"function"==typeof s.handler&&(s.eventType=s.eventType||"click",t("#"+y[v]).off(s.eventType).on(s.eventType,function(t){return function(){s.handler({sender:this,text:t.text||t,item:t})}}(w)))}return u}"text"==s.xtype&&(d().append(s.text),"function"==typeof s.handler&&s.handler())}},addQueryItem:function(a){var i=a.item.id||c+"QueryItm"+n(),r=function(t,e,a){var i="";if(i='<div class="input-group input-group-sm" id="'+(e=(e=t.id||e)||c+"QueryItm"+n())+'" '+l(g)+">",t.children instanceof Array){var r="";"bbar"!=a&&"pbar"!=a||(r="dropup"),i+='<div class="input-group-btn '+r+'">',i+='<button type="button" '+l(b)+' class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">'+t.children[0].text+'<span class="caret"></span></button>',i+='<ul class="dropdown-menu" role="menu" '+l(y)+">";for(var d=0;d<t.children.length;d++)i+='<li><a href="#"'+l(t.children[d].fieldName)+">"+t.children[d].text+"</a></li>";i+="</ul>",i+="</div>",i+='<input type="text" class="form-control" aria-label="..." '+l(t.children[0].fieldName)+">"}else{var s="";t.isLastItem?s=t.text:(i+='<span class="input-group-btn">',i+='<button class="btn btn-default" type="button">'+t.text+"</button>",i+="</span>"),i+='<input type="text" class="form-control" placeholder="'+s+'" '+l(t.fieldName)+">"}return t.isLastItem&&(i+='<span class="input-group-btn">',i+='<button class="btn btn-default" type="button"'+l(v)+">",i+=o("glyphicon-search","查询"),i+="</button>",i+="</span>"),i+="</div>"}(a.item,i,a.xtype);m.Obar.addItem({xtype:a.xtype,item:{xtype:"html",html:r}}),a.item.children instanceof Array&&t("#"+i).find("ul["+l(y,"none")+"]").find("a").off("click").click(function(){t(this).parent("li").parent("ul").siblings("button["+l(b,"none")+"]").html(t(this).html()+'<span class="caret"></span>'),t("#"+i).find("input["+s+"]").attr(s,t(this).attr(s))}),a.item.isLastItem&&t("#"+i).find("button["+l(v,"none")+"]").off("click").click(function(){for(var n=m.Obar.getPanelBodyObj(a.xtype).find("div["+l(g,"none")+"]").find("input["+s+"]"),o={},i=[],r=0;r<n.length;r++){var d=t(n[r]);o[d.attr(s)]=d.val(),d.val()&&i.push({Field:d.attr(s),Value:d.val(),COperator:6,JOperator:0})}e(m.config.quickQuery.handler)({data:o,condition:i})})}},m.Tbar={init:function(){m.config._showTbar&&(m.Tbar.addItem(m.config.toolbar),m.config.quickQuery&&"tbar"==m.config.quickQuery.dock&&m.Tbar.addQueryItem(m.config.quickQuery.items))},clear:function(){this.config.tbar,Array},addItem:function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)m.Tbar.addItem(t[e]);else"object"==typeof t&&m.Obar.addItem({xtype:tbarXtype,item:t})},addQueryItem:function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)e==t.length-1&&(t[e].isLastItem=!0),m.Tbar.addQueryItem(t[e]);else"object"==typeof t&&m.Obar.addQueryItem({xtype:tbarXtype,item:t})},reload:function(t){},needShow:function(){var t=!1;return m.config.toolbar instanceof Array?t=!0:m.config.quickQuery&&"tbar"==m.config.quickQuery.dock&&(t=!0),t}},m.Bbar={init:function(){m.config._showBbar&&(m.config.showMoveRowGroup&&m.Bbar.addMoveRowGroup(),m.config.bbar&&m.Bbar.addItem(m.config.bbar),m.config.quickQuery&&"bbar"==m.config.quickQuery.dock&&m.Bbar.addQueryItem(m.config.quickQuery.items))},addMoveRowGroup:function(){m.config.showMoveRowGroup&&m.Bbar.addItem({xtype:"btnGroup",children:[{text:"至顶部",iconCls:"glyphicon-hand-up",handler:function(){m.rowUpToFirst()}},{text:"上移",iconCls:"glyphicon-arrow-up",handler:function(){m.rowUp()}},{text:"下移",iconCls:"glyphicon-arrow-down",handler:function(){m.rowDown()}},{text:"至底部",iconCls:"glyphicon-hand-down",handler:function(){m.rowDownToLast()}}]})},addItem:function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)m.Bbar.addItem(t[e]);else"object"==typeof t&&m.Obar.addItem({xtype:bbarXtype,item:t})},addQueryItem:function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)e==t.length-1&&(t[e].isLastItem=!0),m.Bbar.addQueryItem(t[e]);else"object"==typeof t&&m.Obar.addQueryItem({xtype:bbarXtype,item:t})},needShow:function(){var t=!1;return m.config.showMoveRowGroup?t=!0:m.config.bbar?t=!0:m.config.quickQuery&&"bbar"==m.config.quickQuery.dock&&(t=!0),t}},m.Pbar={Vars:{activeModel:"classic",model:"classic",pageSize:25,currentPage:1,startIndex:0,totalCount:0,isReloadPage:!0,pageCount:1,recordRange:"0",handler:null,hasExtend:!1,ajax:null},init:function(){if(m.Pbar.needPaging()){var t=m.Pbar,e=m.Pbar.Vars;"classic"==e.model||"auto"==e.model?(t.addClassicItems(),e.activeModel="classic"):alert("当前分页模式暂不支持"),m.config.autoLoad&&t.bind()}},defaults:{model:"classic",pageSize:25,currentPage:1,startIndex:0,totalCount:0,pageCount:1,recordRange:"0",handler:null},sltPageSizeFor:"pbar_sps",crtPageFor:"pbar_crtp",sltCrtPagFor:"pbar_scp",totalCountFor:"pbar_tc",pageCountFor:"pbar_pc",recordRangeFor:"pbar_rr",firstFor:"pbar_first",previousFor:"pbar_prev",nextFor:"pbar_next",lastFor:"pbar_last",getPanelBodyObj:function(e){return e=e||pbarXtype,t("#"+m.frameId).children(".panel-body").children("div["+l(e,"none")+"]")},getBtnObj:function(t){return m.Pbar.getPanelBodyObj().find("button["+l(t,"none")+"]")},addClassicItems:function(){var e=m.Pbar,n=m.Pbar.Vars,o='<div class="btn-group btn-group-sm dropup">';o+='<button type="button" class="btn btn-default" '+l(e.crtPageFor)+">1</button>",o+='<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">',o+='<span class="glyphicon glyphicon-th-list"></span>',o+='<span class="sr-only">Toggle Dropdown</span>',o+="</button>",o+='<ul class="dropdown-menu twiPagingSlt" role="menu" '+l(e.sltCrtPagFor)+">",o+="<li><a>1</a></li>",o+="</ul>",o+="</div>",m.Pbar.addItem({xtype:"btnGroup",cls:"form-inline",children:[{xtype:"html",html:'<span>每页条数：</span><select class="form-control input-sm twiPageSize" '+l(e.sltPageSizeFor)+'><option>10</option><option>20</option><option selected="selected">25</option><option>30</option><option>50</option><option>80</option><option>100</option><option>150</option><option>200</option><option>500</option><option>1000</option></select>',handler:function(){e.getPanelBodyObj().find("select["+l(e.sltPageSizeFor,"none")+"]").on("change",function(){n.pageSize=parseInt(t(this).val()),n.currentPage=1,e.bind()})}},{iconCls:"glyphicon-step-backward",twiFor:e.firstFor,handler:e.Handler.first},{iconCls:"glyphicon-chevron-left",twiFor:e.previousFor,handler:e.Handler.previous},{xtype:"html",html:o},{iconCls:"glyphicon-chevron-right",twiFor:e.nextFor,handler:e.Handler.next},{iconCls:"glyphicon-step-forward",twiFor:e.lastFor,handler:e.Handler.last},{xtype:"html",html:" 显示 <span "+l(e.recordRangeFor)+">0</span> 条，共 <span "+l(e.pageCountFor)+">1</span> 页，共计 <span"+l(e.totalCountFor)+">0</span> 条"}]})},addItem:function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)m.Pbar.addItem(t[e]);else"object"==typeof t&&m.Obar.addItem({xtype:pbarXtype,item:t})},needPaging:function(){if(void 0===m.config.paging)return m.config.paging=!1,!1;if("boolean"==typeof m.config.paging)return m.config.paging;if("object"==typeof m.config.paging){var e=m.Pbar.Vars;return e.hasExtend||((e=t.extend(e,m.config.paging)).hasExtend=!0),!0}return!1},needShow:function(){return m.Pbar.needPaging()},setInfoItemText:function(t,e){m.Pbar.getPanelBodyObj().find("span["+l(t,"none")+"]").html(e)},setCrtPageText:function(t){var e=m.Pbar;m.Pbar.Vars;e.getPanelBodyObj().find("button["+l(e.crtPageFor,"none")+"]").html(t),e.setRecordRegion()},setTotalCount:function(t){var e=m.Pbar,n=m.Pbar.Vars;n.totalCount=t>0?t:0,e.setInfoItemText(e.totalCountFor,n.totalCount),e.setPageCount()},setPageCount:function(){var t=m.Pbar,e=m.Pbar.Vars,n=1;e.totalCount>0&&(n=Math.ceil(e.totalCount/parseFloat(e.pageSize))),e.pageCount=n,t.setInfoItemText(t.pageCountFor,e.pageCount),t.setCrtPageText(e.currentPage),t.setSltCrtPage(),t.setBtnState()},setRecordRegion:function(){var t=m.Pbar,e=m.Pbar.Vars,n="0";1==e.pageCount?n="1-"+e.totalCount:e.pageCount>1&&(n=1==e.currentPage?"1-"+e.pageSize:e.currentPage==e.pageCount?(e.currentPage-1)*e.pageSize+1+"-"+e.totalCount:(e.currentPage-1)*e.pageSize+1+"-"+e.currentPage*e.pageSize),e.recordRange=n,t.setInfoItemText(t.recordRangeFor,e.recordRange)},setSltCrtPage:function(){var e=m.Pbar,n=m.Pbar.Vars,o=e.getPanelBodyObj().find("ul["+l(e.sltCrtPagFor,"none")+"]");o.empty();for(var a=0;a<n.pageCount;a++)o.append("<li><a>"+(a+1)+"</a></li>");e.getPanelBodyObj().find("ul["+l(e.sltCrtPagFor,"none")+"]").find("a").off("click").click(function(){e.Handler.toPage(parseInt(t(this).html()))})},setBtnState:function(){var t=m.Pbar,e=m.Pbar.Vars;e.pageCount>1?1==e.currentPage?(t.getBtnObj(t.firstFor).attr("disabled","disabled"),t.getBtnObj(t.previousFor).attr("disabled","disabled"),t.getBtnObj(t.nextFor).removeAttr("disabled"),t.getBtnObj(t.lastFor).removeAttr("disabled")):e.currentPage==e.pageCount?(t.getBtnObj(t.firstFor).removeAttr("disabled"),t.getBtnObj(t.previousFor).removeAttr("disabled"),t.getBtnObj(t.nextFor).attr("disabled","disabled"),t.getBtnObj(t.lastFor).attr("disabled","disabled")):(t.getBtnObj(t.firstFor).removeAttr("disabled"),t.getBtnObj(t.previousFor).removeAttr("disabled"),t.getBtnObj(t.nextFor).removeAttr("disabled"),t.getBtnObj(t.lastFor).removeAttr("disabled")):(t.getBtnObj(t.firstFor).attr("disabled","disabled"),t.getBtnObj(t.previousFor).attr("disabled","disabled"),t.getBtnObj(t.nextFor).attr("disabled","disabled"),t.getBtnObj(t.lastFor).attr("disabled","disabled"))},bind:function(){var e=m.Pbar,n=m.Pbar.Vars;m.Pbar.Handler;n.ajax||"object"!=typeof d.ajax||(n.ajax=t.extend({},d.ajax),delete n.ajax.success,n.ajax.success=function(t,o,a){m.loadData(t.data,n.pageSize),e.setTotalCount(t.totalCount),"function"==typeof d.ajax.success&&(d.ajax.success(t,o,a),d.ajax.success=void 0)}),n.ajax&&(n.ajax.data.startIndex=n.startIndex,n.ajax.data.pageSize=n.pageSize,Twi.Ajax(n.ajax))},Handler:{first:function(){var t=m.Pbar,e=m.Pbar.Vars;1!=e.currentPage&&(e.currentPage=1,e.startIndex=0,t.setBtnState(),t.bind())},previous:function(){var t=m.Pbar,e=m.Pbar.Vars;e.currentPage>1&&(e.currentPage-=1,e.startIndex-=e.pageSize,t.setBtnState(),t.bind())},next:function(){var t=m.Pbar,e=m.Pbar.Vars;e.currentPage<e.pageCount&&(e.currentPage+=1,e.startIndex+=e.pageSize,t.setBtnState(),t.bind())},last:function(){var t=m.Pbar,e=m.Pbar.Vars;e.currentPage!=e.pageCount&&(e.currentPage=e.pageCount,e.startIndex=(e.currentPage-1)*e.pageSize,t.setBtnState(),t.bind())},toPage:function(t){var e=m.Pbar,n=m.Pbar.Vars;t=(t=t<1?1:t)>n.totalCount?n.totalCount:t,n.currentPage!=t&&(n.currentPage=t,n.startIndex=(n.currentPage-1)*n.pageSize,e.setBtnState(),e.bind())}}},function(){var e="";m.config.skin=m.config.skin||p,m.config.skin=m.config.skin==p?"":"panel-"+m.config.skin,e+='<div id="'+m.frameId+'" class="twiDtMainFrame panel panel-default '+m.config.skin+'">',e+=function(){var t="";return d.title&&(t='<div id="'+m.titleId+'" class="panel-heading">'+d.title+"</div>"),t}(),m.config._showTbar=!1,m.Tbar.needShow()&&(e+='<div class="panel-body tbarBottomBorder">',e+="<div "+l(h)+' class="btn-toolbar form-inline"></div>',e+="</div>",m.config._showTbar=!0),e+="<div "+l("tableContainer")+' class="twiTableContainer"></div>',m.config._showBbar=!1,m.Bbar.needShow()&&(e+='<div class="panel-body bbarTopBorder">',e+="<div "+l(f)+' class="btn-toolbar form-inline"></div>',e+="</div>",m.config._showBbar=!0),m.Pbar.needPaging()&&(e+='<div class="panel-body bbarTopBorder">',e+="<div "+l(u)+' class="btn-toolbar"></div>',e+="</div>"),e+="</div>",t(d.renderTo).append(e),"number"==typeof m.config.width&&t("#"+m.frameId).css("width",m.config.width)}(),m.Tbar.init(),m.Bbar.init(),m._headHtml=function(){var t="";t+="<thead>",t+="<tr>",d._showRowNumber&&(t+='<th style="text-align:center;width:'+d.rownumberer.width+'px;"><div>'+d.rownumberer.text+"</div></th>"),d._showCheckBox&&(t+='<th style="text-align:center;width:'+d.checkBoxCol.width+'px;">',t+=d.multiSelect?'<input type="checkbox" twiDtChkType="all"/>':"#",t+="</th>");for(var e=0;e<d.columns.length;e++){var n=d.columns[e];!0!==n.hidden&&("number"==typeof n.width?t+='<th style="width:'+n.width+'px;"><div'+l(w)+">"+n.text:t+="<th><div"+l(w)+">"+n.text,d.sortable&&!1!==n.orderFields&&(n.orderFields||(n.orderFields=n.fieldName),t+='<span orderfields="'+n.orderFields+'" class="glyphicon glyphicon-arrow-up hidden"></span><span class="glyphicon glyphicon-arrow-down hidden"></span>'),t+="</div></th>")}return t+="</tr>",t+="</thead>"}();var T="";if(T+="<table id="+m.id+' class="table table-hover table-bordered',"boolean"==typeof m.config.striped&&m.config.striped&&(T+=" table-striped"),T+='">',T+=m._headHtml,T+="<tbody></tbody>",T+="</table>",t("#"+m.frameId).children("div["+s+'="tableContainer"]').append(T),this.config._showCheckBox&&t("#"+m.id).children("thead").find(':checkbox[twiDtChkType="all"]').off("click").click(function(){t(this).prop("checked")?m.selectAll():m.unSelectAll()}),d.sortable&&t("#"+m.id).find("thead>tr>th>div["+l(w,"none")+"]").off("click").click(function(){var e=t(this).children(".glyphicon");if(e&&0!=e.length){var n=t(e[0]).hasClass("hidden");t(this).parent("th").parent("tr").find("th>div").children(".glyphicon").addClass("hidden"),n?(t(e[0]).removeClass("hidden"),m._orderFields=t(e[0]).attr("orderfields")+" ASC"):(t(e[1]).removeClass("hidden"),m._orderFields=t(e[0]).attr("orderfields")+" DESC"),"function"==typeof d.sortFn&&d.sortFn({orderFields:m._orderFields})}}),m.Pbar.init(),m.config.autoLoad&&!m.Pbar.needPaging()){var C=t.extend({},d.ajax);delete C.success,C.success=function(t,e,n){m.loadData(t.data),"function"==typeof d.ajax.success&&d.ajax.success(t,e,n)},Twi.Ajax(C)}m.getPanelBodyObj=function(e){return t("#"+m.frameId).children(".panel-body").children("div["+l(e,"none")+"]")},m.getTokenHeight=function(){var e=0;return m.config.title&&(e+=t("#"+m.titleId).outerHeight()),m.Tbar.needShow()&&(e+=m.getPanelBodyObj(tbarXtype).parent().outerHeight()),m.Bbar.needShow()&&(e+=m.getPanelBodyObj(bbarXtype).parent().outerHeight()),m.Pbar.needShow()&&(e+=m.getPanelBodyObj(pbarXtype).parent().outerHeight()),e},"number"==typeof m.config.height&&t("#"+m.frameId).children("div["+s+'="tableContainer"]').css("height",m.config.height-m.getTokenHeight())},Twi.DataTable.prototype.getId=function(){return this.id},Twi.DataTable.prototype.loadData=function(n,o){function a(t,e,n,o){return e&&"string"==typeof e?n=r.getColFormat(e)(n):t&&"function"==typeof t&&(n=t(n,o)),n}if(n instanceof Array){var i=this,r=this;if(r.config._showAsTreeGrid){for(var c=d(n,r.config.treeGrid),s=0;s<n.length;s++){var p=n[s];p._twiTgdIsOver||(p._twiTgdIsLeaf=!0,p._twiChildrenCount=0,p._twiTgdLevel=-1,c.push(p))}n=c}r._data=n,r._idFieldValues=[];var h=r.config.treeGrid;t("#"+r.id).children("tbody").empty();var f=t("#"+r.id).children("thead").find(':checkbox[twiDtChkType="all"]');f.length>0&&f.prop("checked",!1),o=(o=o||n.length)>n.length?n.length:o;for(s=0;s<o;s++){var u='<tr rowIndex="'+s+'">';r.config._showRowNumber&&(u+='<td style="text-align:center;">'+(s+1)+"</td>"),r.config._showCheckBox&&(u+='<td><input type="checkbox" twiDtChkType="row"/></td>');for(var g=colWidth=colStyleWidth="",b=0;b<r.config.columns.length;b++)if(!0!==r.config.columns[b].hidden){g=n[s][r.config.columns[b].fieldName],colWidth=r.config.columns[b].width;var y=r.config.columns[b].format;if(g=a(r.config.columns[b].renderer,y,g,n[s]),colStyleWidth="","number"==typeof colWidth&&(colStyleWidth=' style="width:'+colWidth+'px;" '),0==b&&r.config._showAsTreeGrid){var v="";v=""+n[s][h.parentIDField]==h.rootParentIDValue?n[s]._twiTgdIsLeaf?h[h.model+"IconCls"].onlyRoot:" twiTgParent "+h[h.model+"IconCls"].open:n[s]._twiTgdIsLeaf?-1==n[s]._twiTgdLevel?h[h.model+"IconCls"].childRoot:h[h.model+"IconCls"].leaf:" twiTgParent "+h[h.model+"IconCls"].open;var w="";n[s]._twiTgdLevel>0&&(w=' style="padding-left:'+n[s]._twiTgdLevel*h.preLevelPadding+'px;" ');g='<span class="twiTreeGridIcon glyphicon '+v+'" '+l("tgIcon")+w+' aria-hidden="true"></span>'+g}u+='<td configColIndex="'+b+'"><div '+colStyleWidth+">"+g+"</div></td>"}u+="</tr>",t("#"+r.id).children("tbody").append(u),"string"==typeof r.config.idField&&r._idFieldValues.push(n[s][r.config.idField]);var m=t("#"+r.id).children("tbody").children("tr:last");m.data("rowIndex",m.attr("rowIndex")),m.data("rowData",r._data[m.data("rowIndex")])}t("#"+r.id).children("tbody").children("tr").off("click").on("click",function(){t("#"+r.id).children("tbody").children("tr").removeClass("twiSelected"),t(this).addClass("twiSelected"),r.config.multiSelect||(r.unSelectAll(),t(this).find(':checkbox[twiDtChkType="row"]').prop("checked",!0)),r.fireEvent("rowclick",{tableSelf:i,rowData:t(this).data("rowData"),rowIndex:t(this).data("rowIndex")})}),this.config._showCheckBox&&t("#"+r.id).children("tbody").find(':checkbox[twiDtChkType="row"]').off("click").click(function(e){if(e.stopPropagation(),t(this).prop("checked"))if(t("#"+r.id).children("tbody").children("tr").removeClass("twiSelected"),t(this).parent().parent("tr").addClass("twiSelected"),r.config.multiSelect){var n=!0;t("#"+r.id).children("tbody").find(':checkbox[twiDtChkType="row"]').each(function(){if(!t(this).prop("checked"))return n=!1,!1}),t("#"+r.id).children("thead").find(':checkbox[twiDtChkType="all"]').prop("checked",n)}else r.unSelectAll(),t(this).prop("checked",!0);else t(this).parent().parent("tr").removeClass("twiSelected"),r.config.multiSelect&&t("#"+r.id).children("thead").find(':checkbox[twiDtChkType="all"]').prop("checked",!1)});for(s=0;s<r.config.columns.length;s++){("function"==typeof r.config.columns[s].cellclick||r.config.columns[s].editable)&&t("#"+r.id).children("tbody").children("tr").children("td[configColIndex="+s+"]").off("click").on("click",function(){var n=t(this).attr("configColIndex"),o=t(this).parent("tr").data("rowData"),d=t(this).parent("tr").data("rowIndex"),c=r.config.columns[n].fieldName,s=o[c],p=function(t){return a(r.config.columns[n].renderer,r.config.columns[n].format,t,o)},h=r.config.columns[n].editable;!0===h&&(h={isValidate:function(t){return!0}});var f=this;if(r.config.columns[n].editable){var u='<div class="input-group input-group-sm" '+l("cellEditItem")+">";u+='<input type="text" class="form-control twiCellEditInput" value="'+s+'"/>',u+='<span class="input-group-btn">',u+='<button class="btn btn-default" type="button" '+l("cellEditSave")+">",u+='<span class="glyphicon glyphicon-ok" style="color:#69aa46;" aria-hidden="true"></span>',u+="</button>",u+='<button class="btn btn-default" type="button" '+l("cellEditCancel")+">",u+='<span class="glyphicon glyphicon-remove" style="color:#dd5a43;" aria-hidden="true"></span>',u+="</button>",u+="</span>",u+="</div>",t(f).html(u),t(f).children("div["+l("cellEditItem","none")+"]").off("click").on("click",function(t){t.stopPropagation()}),t(f).find("button["+l("cellEditSave","none")+"]").off("click").on("click",function(a){a.stopPropagation();var l=t(f).find(".twiCellEditInput").val();s!=l?h.isValidate(l)?(t(f).html("<div>"+p(l)+"</div>"),(o=r.getData()[d])[c]=l,s=o[c],t(f).parent("tr").data("rowData",o),e(h.success)({tableSelf:i,rowData:o,rowIndex:d,colData:s,configColIndex:n,colFieldName:c})):e(h.failed)():t(f).html("<div>"+p(s)+"</div>")}),t(f).find("button["+l("cellEditCancel","none")+"]").off("click").on("click",function(e){e.stopPropagation(),t(f).html("<div>"+p(s)+"</div>")})}else r.config.columns[n].cellclick({tableSelf:i,rowData:o,rowIndex:d,colData:s,configColIndex:n,colFieldName:c})})}r.config._showAsTreeGrid&&t("#"+r.id).find("tbody>tr>td").find(".twiTgParent").off("click").click(function(e){var n=t(this),o=parseInt(n.closest("tr").attr("rowIndex")),a=r.getData()[o],i=h[h.model+"IconCls"].close,l=h[h.model+"IconCls"].open;n.hasClass(l)?(t("#"+r.id).find("tbody>tr").slice(o+1,o+1+a._twiChildrenCount).addClass("hidden"),n.removeClass(l).addClass(i)):n.hasClass(h[h.model+"IconCls"].close)&&(t("#"+r.id).find("tbody>tr").slice(o+1,o+1+a._twiChildrenCount).each(function(){t(this).data("rowData")[h.parentIDField]==a[h.idField]&&t(this).removeClass("hidden"),t(this).find(".twiTgParent").hasClass(l)&&t(this).find(".twiTgParent").removeClass(l).addClass(i).click()}),n.removeClass(i).addClass(l)),e.stopPropagation()})}},Twi.DataTable.prototype.editData=function(e){if(e){for(var n=this,o=n.getSelectionsIndex(),a=n.getData(),i=0;i<o.length;i++){var r=a[o[i]];for(j in a[o[i]])j&&"function"!=typeof r[j]&&(e[j]||""==e[j])&&(r[j]=e[j])}n.refresh();for(i=0;i<o.length;i++)n.checkedByIndex(o[i]),n.config._showCheckBox&&t("#"+n.id).children("tbody").find("tr").eq(o[i]).addClass("twiSelected")}},Twi.DataTable.prototype.refresh=function(){this.loadData(this._data)},Twi.DataTable.prototype.reload=function(e){var n=this;if(n.Pbar.needPaging())if(n.config.ajax=e,n.Pbar.Vars.ajax=null,n.Pbar.Vars.isReloadPage||n.Pbar.Vars.currentPage<=1)n.Pbar.Vars.currentPage=0,n.Pbar.Handler.first();else{var o=n.Pbar.Vars.currentPage+0;n.Pbar.Vars.currentPage=0,n.Pbar.Handler.toPage(o)}else{var a=t.extend({},e);delete a.success,a.success=function(t,o,a){n.loadData(t.data),"function"==typeof e.success&&e.success(t,o,a)},Twi.Ajax(a)}},Twi.DataTable.prototype.resize=function(t){t.width&&this.setWidth(t.width),t.height&&this.setHeight(t.height)},Twi.DataTable.prototype.setWidth=function(e){"number"==typeof e&&t("#"+this.frameId).css("width",e)},Twi.DataTable.prototype.setHeight=function(e){if("number"==typeof e){t("#"+this.frameId).children("div["+l("tableContainer","none")+"]").css("height",parseFloat(e)-this.getTokenHeight())}},Twi.DataTable.prototype.getData=function(){return this._data||[]},Twi.DataTable.prototype.getLastSelected=function(){var t=this.getSelections();if(t.length>0)return t[0]},Twi.DataTable.prototype.getSelections=function(){var e=[];return this.config._showCheckBox?t("#"+this.id).children("tbody").find(":checkbox[twiDtChkType]").each(function(){t(this).prop("checked")&&e.push(t(this).parent().parent("tr").data("rowData"))}):t("#"+this.id).children("tbody").children(".twiSelected").each(function(n){e.push(t(this).data("rowData"))}),e},Twi.DataTable.prototype.getLastSelectedIndex=function(){var t=this.getSelectionsIndex();return t.length>0?t[0]:-1},Twi.DataTable.prototype.getSelectionsIndex=function(){var e=[];return this.config._showCheckBox?t("#"+this.id).children("tbody").find(":checkbox[twiDtChkType]").each(function(){t(this).prop("checked")&&e.push(parseInt(t(this).parent().parent("tr").data("rowIndex")))}):t("#"+this.id).children("tbody").children(".twiSelected").each(function(n){e.push(parseInt(t(this).data("rowIndex")))}),e},Twi.DataTable.prototype.selectAll=function(){this.config._showCheckBox&&t("#"+this.id).find(":checkbox[twiDtChkType]").prop("checked",!0)},Twi.DataTable.prototype.unSelectAll=function(){this.config._showCheckBox&&t("#"+this.id).find(":checkbox[twiDtChkType]").prop("checked",!1)},Twi.DataTable.prototype.checkedByKeyValue=function(t,e){for(var n=0;n<this._data.length;n++)this._data[n][t]==e&&this.checkedByIndex(n)},Twi.DataTable.prototype.checkedById=function(t){var e=this;if(e.config._showCheckBox&&"string"==typeof e.config.idField)for(var n=0;n<e._idFieldValues.length;n++)if(e._idFieldValues[n]==t){e.checkedByIndex(n);break}},Twi.DataTable.prototype.checkedByIndex=function(e){var n=this;n.config.multiSelect||n.unSelectAll(),n.config._showCheckBox?t("#"+n.id).children("tbody").find(":checkbox[twiDtChkType]").eq(e).prop("checked",!0):(t("#"+n.id).children("tbody").children("tr").removeClass("twiSelected"),t("#"+n.id).children("tbody").find("tr").eq(e).addClass("twiSelected"))},Twi.DataTable.prototype.rowUp=function(e){var n=this,o=n.getSelectionsIndex();if(!(0==o.length||o[0]<1)){for(c=0;c<o.length;c++){if((s=o[c])>0){var a=n._data,i=a.slice(0,s-1),r=a.slice(s-1,s),l=a.slice(s,s+1),d=a.slice(s+1);n._data=i.concat(l,r,d)}}n.loadData(n._data);for(var c=0;c<o.length;c++){var s=o[c];s>0&&(s-=1),n.checkedByIndex(s),n.config._showCheckBox&&t("#"+n.id).children("tbody").find("tr").eq(s).addClass("twiSelected"),c==o.length-1&&"function"==typeof e&&e()}}},Twi.DataTable.prototype.rowDown=function(e){var n=this,o=n.getSelectionsIndex();if(0!=o.length&&o[o.length-1]!=n._data.length-1){for(c=o.length-1;c>=0;c--){if((s=o[c])>=0&&s<n._data.length-1){var a=n._data,i=a.slice(0,s),r=a.slice(s,s+1),l=a.slice(s+1,s+2),d=a.slice(s+2);n._data=i.concat(l,r,d)}}n.loadData(n._data);for(var c=o.length-1;c>=0;c--){var s=o[c];s<n._data.length-1&&(s+=1),n.checkedByIndex(s),n.config._showCheckBox&&t("#"+n.id).children("tbody").find("tr").eq(s).addClass("twiSelected"),c==o.length-1&&"function"==typeof e&&e()}}},Twi.DataTable.prototype.rowUpToFirst=function(e){var n=this,o=n.getSelectionsIndex();if(!(0==o.length||o[0]<1)){for(p=0;p<o.length;p++){if((h=o[p])>0){var a=h-o[0],i=n._data;if(0==a){var r=i.slice(0,h),l=i.slice(h,h+1),d=i.slice(h+1);n._data=l.concat(r,d)}else{var r=i.slice(0,a),c=i.slice(a,a+1),s=i.slice(a+1,h),l=i.slice(h,h+1),d=i.slice(h+1);n._data=r.concat(l,s,c,d)}}}n.loadData(n._data);for(var p=0;p<o.length;p++){var h=o[p];h-=o[0],n.checkedByIndex(h),n.config._showCheckBox&&t("#"+n.id).children("tbody").find("tr").eq(h).addClass("twiSelected"),p==o.length-1&&"function"==typeof e&&e()}}},Twi.DataTable.prototype.rowDownToLast=function(e){var n=this,o=n.getSelectionsIndex();if(0!=o.length&&o[o.length-1]!=n._data.length-1){for(p=o.length-1;p>=0;p--){if((h=o[p])>=0&&h<n._data.length-1){var a=h+(n._data.length-1-o[o.length-1]),i=n._data;if(a==n._data.length-1){var r=i.slice(0,h),l=i.slice(h,h+1),d=i.slice(h+1);n._data=r.concat(d,l)}else{var r=i.slice(0,h),l=i.slice(h,h+1),c=i.slice(h+1,a),s=i.slice(a,a+1),d=i.slice(a+1);n._data=r.concat(s,c,l,d)}}}n.loadData(n._data);for(var p=o.length-1;p>=0;p--){var h=o[p];h<n._data.length-1&&(h+=n._data.length-1-o[o.length-1]),n.checkedByIndex(h),n.config._showCheckBox&&t("#"+n.id).children("tbody").find("tr").eq(h).addClass("twiSelected"),p==o.length-1&&"function"==typeof e&&e()}}},Twi.DataTable.prototype.addColFormat=function(t,e){if("function"==typeof e){var n=this;n._colFormat=n._colFormat instanceof Array?n._colFormat:[],n._colFormat[t]=[],n._colFormat[t].push(e)}},Twi.DataTable.prototype.getColFormat=function(t){var e=this;if(e._colFormat=e._colFormat instanceof Array?e._colFormat:[],void 0!==e._colFormat[t])return e._colFormat[t][0];if("bool"==t)return e.addColFormat(t,function(t){return"string"==typeof t?"1"==t?'<span style="color:green;">√</span>':"0"==t?"×":t:"boolean"==typeof t?t?'<span style="color:green;">√</span>':"×":t}),e._colFormat[t][0];if("strong"==t)return e.addColFormat(t,function(t){return"<strong>"+t+"</strong>"}),e._colFormat[t][0];if(0==t.indexOf("color#")){n=t.substring(5);return e.addColFormat(t,function(t){return'<span style="color:'+n+';">'+t+"</span>"}),e._colFormat[t][0]}if(0==t.indexOf("scolor#")){var n=t.substring(6);return e.addColFormat(t,function(t){return'<strong style="color:'+n+';">'+t+"</strong>"}),e._colFormat[t][0]}return function(t){return t}},Twi.DataTable.prototype.addListener=function(t,e){void 0===this._handlers[t]&&(this._handlers[t]=[]),"function"==typeof e&&this._handlers[t].push(e)},Twi.DataTable.prototype.on=Twi.DataTable.prototype.addListener,Twi.DataTable.prototype.removeListener=function(t){this._handlers[t]instanceof Array&&(this._handlers[t]=void 0)},Twi.DataTable.prototype.un=Twi.DataTable.prototype.off=Twi.DataTable.prototype.removeListener,Twi.DataTable.prototype.fireEvent=function(t,e){if(e=e||{},this._handlers[t]instanceof Array)for(var n=this._handlers[t],o=0;o<n.length;o++)n[o](e)}}(window.jQuery);
!function(){"undefined"==typeof Twi&&(this.Twi={}),Twi.global=this,Twi.Dialog=function(i){i=$.extend({modal:!0,height:300,width:200,autoHeight:!0,html:"",contentEl:"",showTitle:!0,title:"标题",resizable:!0},i),this.config=i,this.id="TwiDialog"+Math.floor(1e5*Math.random())},Twi.Dialog.prototype.show=function(){var i='<div id="'+this.id+'">';i+='<div class="twiDialogBg"></div>',i+='<div class="twiDialogCnt"><span type="twiLoadingMaskMsg">'+this.msg+"</span></div>",i+="</div>",$("body").append(i)},Twi.Dialog.prototype.close=function(){$("#"+this.id).remove()}}();
!function(n){n.fn.twiDropdown=function(i){i=n.extend({},i);return this.each(function(){n(this).unbind("click").bind("click",function(i){var o=n(this).attr("id");n("ul[to='"+o+"']").toggle(),i.stopPropagation()})})},n(document).off("click.twi.dropdown").on("click.twi.dropdown",function(){n(".twiDropdownMenu").hide()})}(jQuery);
!function(t){function a(a){return t(a).hasClass("form-inline")?1:t(a).hasClass("form-horizontal")?2:0}t.fn.twiFormValidate=function(e,r){if(this.length)return this.each(function(i,o){(u=t.extend({},t.fn.twiFormValidate.defaults,r)).callback=e,t(this).attr("novalidate","novalidate"),F=a(this),l(this)});r&&r.debug&&window.console&&console.warn("初始化twiFormValidate验证失败...")},t.fn.twiIsValidate=function(a){if(e)return!1;e=!0;var i=!1;return t("input, textarea",this).each(function(){var a=t(this),e=a.parents(".form-group"),F=void 0==a.attr("twiforvalidate")?null:a.attr("twiforvalidate").split(" ");!e.hasClass("has-success")&&null!=F&&F.length>0&&(o(this,F)||(0==r&&(scrollTo(0,a[0].offsetTop-50),r=!0),i=!0))}),r=!1,e=!1,!i},t.fn.twiFormValidate.defaults={VERSION:"1.0.0",validPopover:"right",validPopoverArrow:{top:100,bottom:0,left:50,right:50},validRules:[{name:"required",validate:function(a){return""==t.trim(a)},defaultMsg:"请输入内容。"},{name:"number",validate:function(t){return!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},defaultMsg:"请输入数字。"},{name:"mail",validate:function(t){return!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},defaultMsg:"请输入邮箱地址。"},{name:"char",validate:function(t){return!/^[a-z\_\-A-Z]*$/.test(t)},defaultMsg:"请输入英文字符。"},{name:"chinese",validate:function(t){return/[^\u4e00-\u9fa5]/gi.test(t)},defaultMsg:"请输入汉字。"},{name:"url",validate:function(t){return!/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},defaultMsg:"请输入网址"},{name:"date",validate:function(t){return/Invalid|NaN/.test(new Date(t).toString())},defaultMsg:"日期格式XXXX-XX-XX。"}],reqmark:!0,callback:null};var e=!1,r=!1,F=0,u={},o=function(e,r){var F,o=t(e),l=!1,n="",d=o.attr("minlength")?o.attr("minlength"):null,s=o.attr("range")?o.attr("range"):null;for(i=0;i<r.length;i++){var p=!0,f=r[i];F=void 0==o.attr("twi"+f+"msg")?null:o.attr("twi"+f+"msg"),"!"==f.substr(0,1)&&(p=!1,f=f.substr(1,f.length-1));var v=u.validRules;for(j=0;j<v.length;j++){var c=v[j];if(f==c.name){var h;if(h="checkbox"==o.attr("type")?o.is(":checked")?"true":"":o.val(),c.validate.call(e,h)==p){l=!0,n="file"==o.attr("type").toLowerCase()?null==F?"请选择文件。":F:null==F?c.defaultMsg:F;break}}}if(l)break}if(d&&!l&&(!(l=o.val().length<d)||null!=F&&""!=n||(n="输入长度大于等于"+d)),t.inArray("number",r)>=0&&s&&!l){D=s.split("~");if(2==D.length)!(l=parseFloat(o.val())<parseFloat(D[0])||parseFloat(o.val())>parseFloat(D[1]))||null!=F&&""!=n||(n="输入值在［"+D[0]+"~"+D[1]+"]之间。");else{var D;(D=s.split(",")).length>0&&(!(l=t.inArray(o.val(),D)<0)||null!=F&&""!=n||(n="输入值为"+s+"的其中一个。"))}}if(!l&&u.callback){var g={msg:"",err:l},x=t.ajaxSettings.async;t.ajaxSetup({async:!1}),u.callback(e,g),!(l=g.err)||null!=F&&""!=n?""!=g.msg&&(n=g.msg):n=g.msg,t.ajaxSetup({async:x})}var m=o.parents(".form-group");m.removeClass("has-error has-success"),m.addClass(0==l?"has-success":"has-error");var w=o.parents("form");if(w){var C=a(w);m.find("#valierr").remove(),m.find(".twivalierr").remove(),m.find(".popover").remove();var y=u.validPopover,A="0",E=20*n.length,b=m.width(),z=-(m.find(".form-control").get(0).offsetHeight-(null==o.parents(".input-group").height()?m.find(".form-control").height():o.parents(".input-group").height())),k=z;t(window).width()<b+E?(y="top",b=0,A=u.validPopoverArrow.top,z=-m.find(".form-control").get(0).offsetHeight,k=0):y="right";for(var $ in u.validPopoverArrow)if($==y){A=u.validPopoverArrow[$]}if(0==C)0!=o.parents(".input-group").length?""==n?o.after('<span class="glyphicon glyphicon-ok form-control-feedback twivalierr" style="top: '+z+'px;"  aria-hidden="true"></span>'):(o.after("<span title="+n+' style="top: '+k+'px;" class="glyphicon glyphicon-remove form-control-feedback twivalierr" aria-hidden="true"></span>'),m.find(".twivalierr").after('<div class="popover fade '+y+' in" role="tooltip"  style="top: '+z+"px; left: "+b+'px;display: block;"><div class="arrow" style="top: '+A+'%;"></div><div class="popover-content" style="width:'+E+'px">'+n+"</div></div>")):(m.after("<span title="+n+' style="top: '+k+'px;" class="glyphicon glyphicon-remove form-control-feedback twivalierr" aria-hidden="true"></span>'),m.find(".twivalierr").after('<div class="popover fade '+y+' in" role="tooltip"  style="top: '+-z+"px; left: "+b+'px; display: block;"><div class="arrow" style="top: '+A+'%;"></div><div class="popover-content" style="width:'+E+'px">'+n+"</div></div>")),m.parent().find(".popover").click(function(){m.parent().find(".popover").remove()});else if(1==C);else if(2==C){$thisControl=m.find(".form-control");var _=parseInt($thisControl.css("padding-top")),M=parseInt($thisControl.css("padding-left")),X=parseInt($thisControl.css("padding-right"));z=$thisControl.height(),b=0;var I=$thisControl.width()+z+M+X,P=.5*-_,V=-(z-2*_)/2;"top"==y&&(I=0,V=-(z+3.5*_)),""==n?$thisControl.after('<span class="glyphicon glyphicon-ok form-control-feedback twivalierr" style="height: '+z+"px;width: "+z+"px; top: "+P+"px;right: "+z+'px;"  aria-hidden="true"></span>'):($thisControl.after('<span class="glyphicon glyphicon-remove form-control-feedback twivalierr" style="height: '+z+"px;width: "+z+"px; top:  "+P+"px;right: "+z+'px;"  aria-hidden="true"></span>'),$thisControl.after('<div class="popover fade '+y+' in" role="tooltip"  style="top: '+V+"px; left: "+I+'px;display: block;"><div class="arrow" style="top: '+A+'%;"></div><div class="popover-content" style="width:'+E+"px;padding:"+.25*z+'px;">'+n+"</div></div>")),t(w).find(".popover").click(function(){t(w).find(".popover").remove()})}}return!l},l=function(a){t(a).find("input, textarea").each(function(){var a=t(this);a.on("blur",function(){valid=void 0==a.attr("twiforvalidate")?null:a.attr("twiforvalidate").split(" "),valid&&o(this,valid)}),a.on("focus",function(){valid=void 0==a.attr("twiforvalidate")?null:a.attr("twiforvalidate").split(" "),valid&&a.parent().find(".popover").remove()})}),t(a).find("input[type='file']").each(function(){var a=t(this);a.on("change",function(){valid=void 0==a.attr("twiforvalidate")?null:a.attr("twiforvalidate").split(" "),valid&&o(this,valid)})}),1==u.reqmark&&(0==F?t(a).find(".form-group>label").each(function(){var a=t(this).parents(".form-group");a.removeClass("has-error has-success"),a.find("#autoreqmark").remove()}):1==F||2==F&&t(a).find("input, textarea").each(function(){var a=t(this),e=a.parents(".form-group");e.removeClass("has-error has-success"),e.find("#valierr").remove(),valid=void 0==a.attr("twiforvalidate")?null:a.attr("twiforvalidate").split(" "),valid&&t.inArray("required",valid)}))}}(window.jQuery);
!function(i){"undefined"==typeof Twi&&(this.Twi={emptyFn:function(){}}),Twi.global=this,Twi.Window=Twi.Win=function(n){var t=this;t.VERSION="1.0.4",t.defaults={title:"这里是标题",html:"这里是内容",renderTo:"body",contentEl:null,width:300,height:230,isFullScreen:!1,id:"TwiWin"+function(i){return i=i||4,Math.floor(Math.pow(10,i)*Math.random())}()},t.config=i.extend({},t.defaults,n),t.id=t.config.id};var n=!1,t=0,o=0;Twi.Win.prototype.show=function(){var e=this,c='<div class="twiWinContainer" id="'+e.config.id+'">';c+='<div class="twiWinBg"></div>',c+='<div class="twiWinContent">',c+='<div class="twiWinFullScreen">',c+='<span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>',c+="</div>",c+='<div class="twiWinClose">',c+='<span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>',c+="</div>";e.config.title.length>0&&(c+='<div class="twiWinTitle">'+e.config.title+"</div>"),c+='<div class="twiWinBody">',c+=e.config.html,c+="</div>",c+="</div>",c+="</div>",i(e.config.renderTo).append(c),e.config.contentEl&&i(e.config.contentEl).length>0&&i("#"+e.config.id).find(".twiWinBody").empty().append(i(e.config.contentEl).html());var f=i("#"+e.config.id);i("#"+e.config.id).find(".twiWinContent").css({width:e.config.width,height:e.config.height,"margin-top":0-e.config.height/2,"margin-left":0-e.config.width/2});var d=i("#"+e.config.id).find(".twiWinTitle").height()||0;d=0==d?0:d+15;var g=e.config.height-d;i("#"+e.config.id).find(".twiWinBody").css({height:g}),f.find(".twiWinFullScreen").click(function(){e.fullScreen()}),f.find(".twiWinClose").click(function(){e.close()});var l=f.find(".twiWinTitle");i(l).on("mousedown",function(i){1==i.which&&(n=!0,t=i.pageX,o=i.pageY),i.stopPropagation()}),i(l).on("mouseup",function(i){1==i.which&&(n=!1),i.stopPropagation()}),i(l).on("mousemove",function(i){if(n){var e=Math.abs(i.pageX)-Math.abs(t),c=Math.abs(i.pageY)-Math.abs(o),d=f.find(".twiWinContent").offset(),g=d.left+e,l=d.top+c;f.find(".twiWinContent").offset({left:g,top:l}),t=i.pageX,o=i.pageY,i.stopPropagation()}})},Twi.Win.prototype.fullScreen=function(){var n=this,t=n.config.id;n.config.isFullScreen?i("#"+t+" .twiWinContent").css({height:n.config.height,width:n.config.width,"margin-top":0-n.config.height/2,"margin-left":0-n.config.width/2,top:"50%",left:"50%"}):i("#"+t+" .twiWinContent").css({height:i(window).height()-20,width:i(window).width()-20,"margin-top":0,"margin-left":0,top:0,left:0}),n.config.isFullScreen=!n.config.isFullScreen;var o=i("#"+n.config.id).find(".twiWinTitle").height()||0;o=0==o?0:o+15;var e=i("#"+t+" .twiWinContent").height()-o;i("#"+n.config.id).find(".twiWinBody").css({height:e}),"function"==typeof n.config.fullScreenFn&&n.config.fullScreenFn({isFullScreen:n.config.isFullScreen,width:i("#"+t+" .twiWinContent").width(),height:i("#"+t+" .twiWinContent").height()})},Twi.Win.prototype.close=function(){i("#"+this.config.id).remove()},Twi.Win.prototype.getId=function(){return this.config.id}}(window.jQuery);